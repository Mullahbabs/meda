<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MEDA User Portal</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Poppins:wght@600&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-color: #092a49;
        --secondary-color: #1a3a6a;
        --accent-color: #ff4444;
        --success-color: #4caf50;
        --warning-color: #ff9800;
        --light-bg: #f8f9fa;
        --white: #ffffff;
        --dark-text: #2c3e50;
        --light-text: #7f8c8d;
        --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Lato", sans-serif;
        background-color: var(--light-bg);
        color: var(--dark-text);
        line-height: 1.6;
      }

      h1,
      h2,
      h3,
      h4 {
        font-family: "Poppins", sans-serif;
        color: var(--primary-color);
      }

      a {
        text-decoration: none;
        color: var(--primary-color);
        transition: var(--transition);
      }

      a:hover {
        color: var(--accent-color);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Auth Pages */
      .auth-container {
        display: flex;
        min-height: 100vh;
      }

      .auth-left {
        flex: 1;
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--secondary-color) 100%
        );
        color: var(--white);
        padding: 60px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
      }

      .auth-left h1 {
        color: var(--white);
        margin-bottom: 20px;
        font-size: 2.5rem;
      }

      .auth-left p {
        max-width: 500px;
        margin-bottom: 40px;
      }

      .auth-right {
        flex: 1;
        background-color: var(--white);
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding: 60px;
      }

      .auth-logo {
        width: 120px;
        margin-bottom: 30px;
        border-radius: 50px;
      }

      .auth-form {
        max-width: 400px;
        width: 100%;
        margin: 0 auto;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .form-control {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 1rem;
        transition: var(--transition);
      }

      .form-control:focus {
        border-color: var(--primary-color);
        outline: none;
        box-shadow: 0 0 0 3px rgba(9, 42, 73, 0.1);
      }

      .btn {
        display: inline-block;
        padding: 12px 24px;
        background-color: var(--primary-color);
        color: var(--white);
        border: none;
        border-radius: 4px;
        font-size: 1rem;
        cursor: pointer;
        transition: var(--transition);
        text-align: center;
      }

      .btn:hover {
        background-color: var(--secondary-color);
      }

      .btn-accent {
        background-color: var(--accent-color);
      }

      .btn-accent:hover {
        background-color: #e53935;
      }

      .btn-block {
        display: block;
        width: 100%;
      }

      .auth-footer {
        margin-top: 20px;
        text-align: center;
      }

      /* Dashboard */
      .dashboard {
        display: flex;
        min-height: 100vh;
      }

      .sidebar {
        width: 250px;
        background-color: var(--primary-color);
        color: var(--white);
        padding: 30px 0;
        transition: var(--transition);
      }

      .sidebar-header {
        padding: 0 20px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 20px;
      }

      .sidebar-logo {
        width: 120px;
        margin-bottom: 10px;
        border-radius: 50px;
      }

      .sidebar-user {
        display: flex;
        align-items: center;
        padding: 10px 20px;
        margin-bottom: 20px;
      }

      .sidebar-user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: var(--accent-color);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
        font-weight: bold;
        font-size: 1.1rem;
      }

      .sidebar-user-info h4 {
        color: var(--white);
        margin-bottom: 2px;
        font-size: 0.9rem;
      }

      .sidebar-user-info p {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.8rem;
      }

      .sidebar-menu {
        list-style: none;
      }

      .sidebar-menu li a {
        display: flex;
        align-items: center;
        padding: 12px 20px;
        color: rgba(255, 255, 255, 0.8);
        transition: var(--transition);
      }

      .sidebar-menu li a:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: var(--white);
      }

      .sidebar-menu li a.active {
        background-color: rgba(255, 255, 255, 0.2);
        color: var(--white);
        border-left: 3px solid var(--accent-color);
      }

      .sidebar-menu li a i {
        margin-right: 10px;
        width: 20px;
        text-align: center;
      }

      .main-content {
        flex: 1;
        padding: 30px;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
      }

      .header h2 {
        font-size: 1.8rem;
      }

      .header-actions {
        display: flex;
        align-items: center;
      }

      .notification-btn {
        position: relative;
        margin-right: 20px;
        color: var(--dark-text);
        font-size: 1.2rem;
      }

      .notification-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: var(--accent-color);
        color: var(--white);
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .user-dropdown {
        position: relative;
      }

      .user-dropdown-btn {
        display: flex;
        align-items: center;
        cursor: pointer;
      }

      .user-dropdown-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background-color: var(--primary-color);
        color: var(--white);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 8px;
        font-weight: bold;
        font-size: 1rem;
      }

      .user-dropdown-menu {
        position: absolute;
        right: 0;
        top: 50px;
        background-color: var(--white);
        border-radius: 4px;
        box-shadow: var(--shadow);
        width: 200px;
        padding: 10px 0;
        z-index: 100;
        display: none;
      }

      .user-dropdown:hover .user-dropdown-menu,
      .user-dropdown.active .user-dropdown-menu {
        display: block;
      }

      .user-dropdown-menu a {
        display: block;
        padding: 10px 20px;
        color: var(--dark-text);
        transition: var(--transition);
      }

      .user-dropdown-menu a:hover {
        background-color: var(--light-bg);
        color: var(--primary-color);
      }

      .card {
        background-color: var(--white);
        border-radius: 8px;
        box-shadow: var(--shadow);
        padding: 20px;
        margin-bottom: 20px;
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }

      .card-header h3 {
        font-size: 1.2rem;
      }

      .welcome-card {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--secondary-color) 100%
        );
        color: var(--white);
      }

      .welcome-card h3 {
        color: var(--white);
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background-color: var(--white);
        border-radius: 8px;
        box-shadow: var(--shadow);
        padding: 20px;
        text-align: center;
      }

      .stat-card h4 {
        color: var(--light-text);
        font-size: 0.9rem;
        margin-bottom: 10px;
      }

      .stat-card p {
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--primary-color);
      }

      .stat-card.success p {
        color: var(--success-color);
      }

      .stat-card.warning p {
        color: var(--warning-color);
      }

      .table-responsive {
        overflow-x: auto;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }

      th {
        background-color: var(--light-bg);
        font-weight: 600;
      }

      tr:hover {
        background-color: var(--light-bg);
      }

      .status-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .status-pending {
        background-color: #fff3cd;
        color: #856404;
      }

      .status-approved {
        background-color: #d4edda;
        color: #155724;
      }

      .status-disbursed {
        background-color: #d1ecf1;
        color: #0c5460;
      }

      .status-rejected {
        background-color: #f8d7da;
        color: #721c24;
      }

      .status-repaid {
        background-color: #d4edda;
        color: #155724;
      }

      .loan-form .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
      }

      .loan-form .form-group {
        margin-bottom: 0;
      }

      /* Modal */
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .modal.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background-color: var(--white);
        border-radius: 8px;
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        transform: translateY(-20px);
        transition: var(--transition);
      }

      .modal.active .modal-content {
        transform: translateY(0);
      }

      .modal-header {
        padding: 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h3 {
        font-size: 1.3rem;
      }

      .modal-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--light-text);
      }

      .modal-body {
        padding: 20px;
      }

      .modal-footer {
        padding: 20px;
        border-top: 1px solid #eee;
        display: flex;
        justify-content: flex-end;
        gap: 10px; /* Added gap for buttons */
      }

      /* Responsive */
      @media (max-width: 992px) {
        .auth-container {
          flex-direction: column;
        }

        .auth-left,
        .auth-right {
          padding: 40px 20px;
        }

        .dashboard {
          flex-direction: column;
        }

        .sidebar {
          width: 100%;
          padding: 20px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap; /* Allow sidebar content to wrap */
        }

        .sidebar-header {
          border-bottom: none;
          padding-bottom: 0;
          margin-bottom: 0;
        }

        .sidebar-logo {
          width: 80px; /* Smaller logo on mobile */
        }

        .sidebar-user {
          padding: 0;
          margin-bottom: 0;
        }

        .sidebar-menu {
          display: flex;
          overflow-x: auto;
          width: 100%;
          margin-top: 20px;
          justify-content: center; /* Center menu items */
        }

        .sidebar-menu li {
          flex-shrink: 0;
        }

        .sidebar-menu li a {
          padding: 10px 15px;
          white-space: nowrap; /* Prevent text wrapping in nav items */
          flex-direction: column; /* Stack icon and text */
          font-size: 0.8rem;
        }

        .sidebar-menu li a i {
          margin-right: 0;
          margin-bottom: 5px; /* Space between icon and text */
        }

        .main-content {
          padding: 20px;
        }

        .loan-form .form-row {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .stats-grid {
          grid-template-columns: 1fr;
        }

        .header {
          flex-direction: column;
          align-items: flex-start;
        }

        .header-actions {
          margin-top: 15px;
          width: 100%;
          justify-content: space-between; /* Distribute actions */
        }

        .user-dropdown {
          flex-grow: 1; /* Allow dropdown to take space */
          display: flex;
          justify-content: flex-end;
        }

        .user-dropdown-menu {
          top: 45px; /* Adjust dropdown position */
        }
      }

      @media (max-width: 480px) {
        .auth-left h1 {
          font-size: 2rem;
        }

        .auth-left,
        .auth-right {
          padding: 30px 15px;
        }

        .auth-logo {
          width: 100px;
        }

        .form-control {
          padding: 10px 12px;
          font-size: 0.9rem;
        }

        .btn {
          padding: 10px 20px;
          font-size: 0.9rem;
        }

        .modal-content {
          width: 95%;
        }

        .modal-header h3 {
          font-size: 1.1rem;
        }

        .modal-close {
          font-size: 1.3rem;
        }
      }
    </style>
  </head>
  <body>
    <div id="authScreens">
      <div class="auth-container" id="signupScreen">
        <div class="auth-left">
          <img src="IMG/loggo9.jpeg" alt="MEDA Logo" class="auth-logo" />
          <h1>Join MEDA Programs</h1>
          <p>
            Access financial empowerment programs, track your loan applications,
            and grow your business with our support.
          </p>
        </div>
        <div class="auth-right">
          <form class="auth-form" id="signupForm">
            <h2>Create Account</h2>
            <p>Please fill in your details to register</p>

            <div class="form-group">
              <label class="form-label" for="signupFullName">Full Name</label>
              <input
                type="text"
                class="form-control"
                id="signupFullName"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupEmail">Email Address</label>
              <input
                type="email"
                class="form-control"
                id="signupEmail"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupPhone">Phone Number</label>
              <input
                type="tel"
                class="form-control"
                id="signupPhone"
                pattern="[0-9]{11}"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupPassword">Password</label>
              <input
                type="password"
                class="form-control"
                id="signupPassword"
                minlength="8"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupConfirmPassword"
                >Confirm Password</label
              >
              <input
                type="password"
                class="form-control"
                id="signupConfirmPassword"
                minlength="8"
                required
              />
            </div>

            <button type="submit" class="btn btn-block">Create Account</button>

            <div class="auth-footer">
              <p>
                Already have an account? <a href="#" id="showLogin">Log in</a>
              </p>
            </div>
          </form>
        </div>
      </div>

      <div class="auth-container" id="loginScreen" style="display: none">
        <div class="auth-left">
          <img src="img/loggo9.jpeg" alt="MEDA Logo" class="auth-logo" />
          <h1>Welcome Back</h1>
          <p>
            Access your MEDA account to manage your loan applications and
            program participation.
          </p>
        </div>
        <div class="auth-right">
          <form class="auth-form" id="loginForm">
            <h2>Login to Your Account</h2>
            <p>Enter your credentials to continue</p>

            <div class="form-group">
              <label class="form-label" for="loginEmail">Email Address</label>
              <input
                type="email"
                class="form-control"
                id="loginEmail"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="loginPassword">Password</label>
              <input
                type="password"
                class="form-control"
                id="loginPassword"
                required
              />
            </div>

            <div class="form-group">
              <a href="#" id="showForgotPassword">Forgot password?</a>
            </div>

            <button type="submit" class="btn btn-block">Login</button>

            <div class="auth-footer">
              <p>
                Don't have an account? <a href="#" id="showSignup">Sign up</a>
              </p>
            </div>
          </form>
        </div>
      </div>

      <div
        class="auth-container"
        id="forgotPasswordScreen"
        style="display: none"
      >
        <div class="auth-left">
          <img src="img/loggo9.jpeg" alt="MEDA Logo" class="auth-logo" />
          <h1>Reset Your Password</h1>
          <p>
            Enter your email or MEDA ID to receive password reset instructions.
          </p>
        </div>
        <div class="auth-right">
          <form class="auth-form" id="forgotPasswordForm">
            <h2>Forgot Password</h2>
            <p>We'll send you a link to reset your password</p>

            <div class="form-group">
              <label class="form-label" for="forgotEmail">Email Address</label>
              <input
                type="email"
                class="form-control"
                id="forgotEmail"
                required
              />
            </div>

            <button type="submit" class="btn btn-block">Send Reset Link</button>

            <div class="auth-footer">
              <p>
                Remember your password?
                <a href="#" id="showLoginFromForgot">Log in</a>
              </p>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="dashboard" style="display: none">
      <div class="sidebar">
        <div class="sidebar-header">
          <img src="img/loggo9.jpeg" alt="MEDA Logo" class="sidebar-logo" />
        </div>

        <div class="sidebar-user">
          <div class="sidebar-user-avatar" id="userAvatar"></div>
          <div class="sidebar-user-info">
            <h4 id="userName"></h4>
            <p id="userId">MEDA-ID: <span id="medaIdDisplay"></span></p>
          </div>
        </div>

        <ul class="sidebar-menu">
          <li>
            <a href="#" class="active" id="menuDashboard"
              ><i class="fas fa-home"></i> Dashboard</a
            >
          </li>
          <li>
            <a href="#" id="menuLoans"
              ><i class="fas fa-hand-holding-usd"></i> Loan Applications</a
            >
          </li>
          <li>
            <a href="#" id="menuPrograms"
              ><i class="fas fa-project-diagram"></i> My Programs</a
            >
          </li>
          <li>
            <a href="#" id="menuProfile"><i class="fas fa-user"></i> Profile</a>
          </li>
          <li>
            <a href="#" id="menuSupport"
              ><i class="fas fa-question-circle"></i> Support</a
            >
          </li>
          <li>
            <a href="#" id="logoutBtn"
              ><i class="fas fa-sign-out-alt"></i> Logout</a
            >
          </li>
        </ul>
      </div>

      <div class="main-content">
        <div class="header">
          <h2 id="dashboardTitle">Dashboard</h2>
          <div class="header-actions">
            <a href="#" class="notification-btn">
              <i class="fas fa-bell"></i>
              <span class="notification-badge">3</span>
            </a>
            <div class="user-dropdown">
              <div class="user-dropdown-btn">
                <div class="user-dropdown-avatar" id="headerUserAvatar"></div>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="user-dropdown-menu">
                <a href="#" id="dropdownProfile"
                  ><i class="fas fa-user"></i> Profile</a
                >
                <a href="#"><i class="fas fa-cog"></i> Settings</a>
                <a href="#" id="logoutBtn"
                  ><i class="fas fa-sign-out-alt"></i> Logout</a
                >
              </div>
            </div>
          </div>
        </div>

        <div id="dashboardContent">
          <div class="card welcome-card">
            <div class="card-header">
              <h3>Welcome back, <span id="welcomeUserName">User</span>!</h3>
            </div>
            <p>
              You're enrolled in the <strong id="userProgram">YOU-LEAP</strong>
              program. Track your loan applications and program progress below.
            </p>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <h4>Active Loans</h4>
              <p id="activeLoansCount">0</p>
            </div>
            <div class="stat-card success">
              <h4>Approved Loans</h4>
              <p id="approvedLoansCount">0</p>
            </div>
            <div class="stat-card">
              <h4>Total Applications</h4>
              <p id="totalApplicationsCount">0</p>
            </div>
            <div class="stat-card warning">
              <h4>Pending Applications</h4>
              <p id="pendingApplicationsCount">0</p>
            </div>
            <div class="stat-card success">
              <h4>Loans Repaid</h4>
              <p id="loansRepaidCount">0</p>
            </div>
          </div>

          <div class="card" id="recentLoansCard">
            <div class="card-header">
              <h3>Recent Loan Applications</h3>
              <button class="btn btn-accent" id="newLoanBtn">
                New Application
              </button>
            </div>
            <div class="table-responsive">
              <table id="loansTable">
                <thead>
                  <tr>
                    <th>Loan ID</th>
                    <th>Amount</th>
                    <th>Date Applied</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <div class="card" id="programProgressCard">
            <div class="card-header">
              <h3>Program Progress</h3>
            </div>
            <p>
              You are currently at <strong id="programPhase">Phase 2</strong> of
              the <span id="programName">YOU-LEAP</span> program. Next training
              session: <strong id="nextTrainingDate">Dec 5, 2023</strong>.
            </p>
            <div
              style="
                margin-top: 20px;
                height: 10px;
                background-color: #eee;
                border-radius: 5px;
              "
            >
              <div
                id="programProgressBar"
                style="
                  width: 60%;
                  height: 100%;
                  background-color: var(--primary-color);
                  border-radius: 5px;
                "
              ></div>
            </div>
          </div>
        </div>

        <div class="modal" id="loanModal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>New Loan Application</h3>
              <button class="modal-close" id="closeLoanModal">×</button>
            </div>
            <div class="modal-body">
              <form id="loanApplicationForm" class="loan-form">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="loanAmount"
                      >Loan Amount (₦)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="loanAmount"
                      min="10000"
                      max="500000"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="loanPurpose">Purpose</label>
                    <select class="form-control" id="loanPurpose" required>
                      <option value="">Select purpose</option>
                      <option value="business">Business Expansion</option>
                      <option value="equipment">Equipment Purchase</option>
                      <option value="inventory">Inventory Restock</option>
                      <option value="other">Other</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label" for="loanDescription"
                    >Brief Description</label
                  >
                  <textarea
                    class="form-control"
                    id="loanDescription"
                    rows="3"
                    required
                  ></textarea>
                </div>

                <div class="form-group">
                  <label class="form-label" for="repaymentPlan"
                    >Preferred Repayment Plan</label
                  >
                  <select class="form-control" id="repaymentPlan" required>
                    <option value="">Select plan</option>
                    <option value="3months">3 Months</option>
                    <option value="6months">6 Months</option>
                    <option value="12months">12 Months</option>
                  </select>
                </div>

                <div class="form-group">
                  <div class="form-check">
                    <input type="checkbox" id="loanTerms" required />
                    <label for="loanTerms"
                      >I agree to the loan terms and conditions</label
                    >
                  </div>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button class="btn" id="cancelLoanBtn">Cancel</button>
              <button
                type="submit"
                class="btn btn-accent"
                id="submitLoanBtn"
                form="loanApplicationForm"
              >
                Submit Application
              </button>
            </div>
          </div>
        </div>

        <div class="modal" id="loanDetailModal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>Loan Application Details</h3>
              <button class="modal-close" id="closeLoanDetailModal">×</button>
            </div>
            <div class="modal-body">
              <div id="loanDetailContent"></div>
            </div>
            <div class="modal-footer">
              <button class="btn" id="closeDetailBtn">Close</button>
            </div>
          </div>
        </div>

        <div class="modal" id="profileModal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>User Profile</h3>
              <button class="modal-close" id="closeProfileModal">×</button>
            </div>
            <div class="modal-body">
              <form id="profileForm">
                <div class="form-group">
                  <label class="form-label" for="profileFullName"
                    >Full Name</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="profileFullName"
                    readonly
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="profileEmail"
                    >Email Address</label
                  >
                  <input
                    type="email"
                    class="form-control"
                    id="profileEmail"
                    readonly
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="profilePhone"
                    >Phone Number</label
                  >
                  <input
                    type="tel"
                    class="form-control"
                    id="profilePhone"
                    readonly
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="profileMedaId">MEDA ID</label>
                  <input
                    type="text"
                    class="form-control"
                    id="profileMedaId"
                    readonly
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="profileProgram"
                    >Enrolled Program</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="profileProgram"
                    readonly
                  />
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button class="btn" id="editProfileBtn">Edit Profile</button>
              <button
                class="btn btn-accent"
                id="saveProfileBtn"
                style="display: none"
              >
                Save Changes
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Helper function to generate MEDA ID
      function generateMedaId() {
        const prefix = "MEDA";
        const randomNum = Math.floor(100000 + Math.random() * 900000);
        return prefix + randomNum;
      }

      // Function to get initials from full name
      function getInitials(fullName) {
        if (!fullName) return "MU"; // MEDA User if no name
        const names = fullName.split(" ").filter(Boolean); // Filter out empty strings
        if (names.length === 0) return "MU";
        if (names.length === 1) return names[0].charAt(0).toUpperCase();
        return (
          names[0].charAt(0).toUpperCase() +
          names[names.length - 1].charAt(0).toUpperCase()
        );
      }

      // Function to save user data to local storage
      function saveUserData(user) {
        localStorage.setItem("currentUser", JSON.stringify(user));
      }

      // Function to get user data from local storage
      function loadUserData() {
        const userData = localStorage.getItem("currentUser");
        return userData ? JSON.parse(userData) : null;
      }

      // Function to save registered users
      function saveRegisteredUsers(users) {
        localStorage.setItem("registeredUsers", JSON.stringify(users));
      }

      // Function to load registered users
      function loadRegisteredUsers() {
        const usersData = localStorage.getItem("registeredUsers");
        return usersData ? JSON.parse(usersData) : [];
      }

      // Function to update a user in registeredUsers
      function updateRegisteredUser(updatedUser) {
        let users = loadRegisteredUsers();
        const index = users.findIndex(
          (user) => user.email === updatedUser.email
        );
        if (index !== -1) {
          users[index] = updatedUser;
          saveRegisteredUsers(users);
        }
      }

      // DOM Elements
      const authScreens = document.getElementById("authScreens");
      const signupScreen = document.getElementById("signupScreen");
      const loginScreen = document.getElementById("loginScreen");
      const forgotPasswordScreen = document.getElementById(
        "forgotPasswordScreen"
      );
      const dashboard = document.getElementById("dashboard");

      const signupForm = document.getElementById("signupForm");
      const loginForm = document.getElementById("loginForm");
      const forgotPasswordForm = document.getElementById("forgotPasswordForm");

      const showLoginBtn = document.getElementById("showLogin");
      const showSignupBtn = document.getElementById("showSignup");
      const showForgotPasswordBtn =
        document.getElementById("showForgotPassword");
      const showLoginFromForgotBtn = document.getElementById(
        "showLoginFromForgot"
      );

      const userAvatar = document.getElementById("userAvatar");
      const userName = document.getElementById("userName");
      const medaIdDisplay = document.getElementById("medaIdDisplay");
      const welcomeUserName = document.getElementById("welcomeUserName");
      const userProgram = document.getElementById("userProgram");
      const headerUserAvatar = document.getElementById("headerUserAvatar");
      const logoutBtn = document.getElementById("logoutBtn");
      const dropdownProfileBtn = document.getElementById("dropdownProfile");

      const activeLoansCount = document.getElementById("activeLoansCount");
      const approvedLoansCount = document.getElementById("approvedLoansCount");
      const totalApplicationsCount = document.getElementById(
        "totalApplicationsCount"
      );
      const pendingApplicationsCount = document.getElementById(
        "pendingApplicationsCount"
      );
      const loansRepaidCount = document.getElementById("loansRepaidCount"); // New element

      const loansTableBody = document.querySelector("#loansTable tbody");
      const newLoanBtn = document.getElementById("newLoanBtn");

      const loanModal = document.getElementById("loanModal");
      const closeLoanModalBtn = document.getElementById("closeLoanModal");
      const cancelLoanBtn = document.getElementById("cancelLoanBtn");
      const submitLoanBtn = document.getElementById("submitLoanBtn");
      const loanApplicationForm = document.getElementById(
        "loanApplicationForm"
      );

      const loanDetailModal = document.getElementById("loanDetailModal");
      const closeLoanDetailModalBtn = document.getElementById(
        "closeLoanDetailModal"
      );
      const closeDetailBtn = document.getElementById("closeDetailBtn");
      const loanDetailContent = document.getElementById("loanDetailContent");

      const profileModal = document.getElementById("profileModal");
      const closeProfileModalBtn = document.getElementById("closeProfileModal");
      const menuProfile = document.getElementById("menuProfile");
      const profileForm = document.getElementById("profileForm");
      const editProfileBtn = document.getElementById("editProfileBtn");
      const saveProfileBtn = document.getElementById("saveProfileBtn");

      let currentUser = loadUserData(); // Load user on script start

      // Function to navigate between auth screens
      function showScreen(screenToShow) {
        signupScreen.style.display = "none";
        loginScreen.style.display = "none";
        forgotPasswordScreen.style.display = "none";
        dashboard.style.display = "none";

        if (screenToShow === "signup") {
          signupScreen.style.display = "flex";
        } else if (screenToShow === "login") {
          loginScreen.style.display = "flex";
        } else if (screenToShow === "forgotPassword") {
          forgotPasswordScreen.style.display = "flex";
        } else if (screenToShow === "dashboard") {
          authScreens.style.display = "none";
          dashboard.style.display = "flex";
        }
      }

      // Update dashboard UI with user data
      function updateDashboardUI() {
        if (!currentUser) {
          showScreen("login");
          return;
        }

        const initials = getInitials(currentUser.fullName);
        userAvatar.textContent = initials;
        headerUserAvatar.textContent = initials;
        userName.textContent = currentUser.fullName.toUpperCase();
        medaIdDisplay.textContent = currentUser.medaId;
        welcomeUserName.textContent = currentUser.fullName.split(" ")[0];
        userProgram.textContent = currentUser.program || "No Program Enrolled";

        // Update loan statistics
        const activeLoans = currentUser.loans.filter(
          (loan) =>
            loan.status !== "repaid" &&
            loan.status !== "rejected" &&
            loan.status !== "cancelled"
        ).length;
        const approvedLoans = currentUser.loans.filter(
          (loan) => loan.status === "approved" || loan.status === "disbursed"
        ).length;
        const totalApplications = currentUser.loans.length;
        const pendingApplications = currentUser.loans.filter(
          (loan) => loan.status === "pending"
        ).length;
        const loansRepaid = currentUser.loans.filter(
          (loan) => loan.status === "repaid"
        ).length; // Count repaid loans

        activeLoansCount.textContent = activeLoans;
        approvedLoansCount.textContent = approvedLoans;
        totalApplicationsCount.textContent = totalApplications;
        pendingApplicationsCount.textContent = pendingApplications;
        loansRepaidCount.textContent = loansRepaid; // Display repaid loans

        renderLoansTable();
        showScreen("dashboard");
      }

      // Render loans table
      function renderLoansTable() {
        loansTableBody.innerHTML = "";
        if (currentUser && currentUser.loans.length > 0) {
          currentUser.loans.forEach((loan) => {
            const row = loansTableBody.insertRow();
            row.innerHTML = `
                <td>${loan.id}</td>
                <td>₦${loan.amount.toLocaleString()}</td>
                <td>${loan.date}</td>
                <td><span class="status-badge status-${loan.status}">${
              loan.status.charAt(0).toUpperCase() + loan.status.slice(1)
            }</span></td>
                <td><a href="#" class="view-loan" data-loan-id="${
                  loan.id
                }">View</a></td>
            `;
          });

          document.querySelectorAll(".view-loan").forEach((button) => {
            button.addEventListener("click", function (e) {
              e.preventDefault();
              const loanId = this.dataset.loanId;
              displayLoanDetails(loanId);
            });
          });
        } else {
          const row = loansTableBody.insertRow();
          row.innerHTML = `<td colspan="5" style="text-align: center;">No loan applications yet.</td>`;
        }
      }

      // Display loan details in modal
      function displayLoanDetails(loanId) {
        const loan = currentUser.loans.find((l) => l.id === loanId);
        if (loan) {
          loanDetailContent.innerHTML = `
            <p><strong>Loan ID:</strong> ${loan.id}</p>
            <p><strong>Amount:</strong> ₦${loan.amount.toLocaleString()}</p>
            <p><strong>Date Applied:</strong> ${loan.date}</p>
            <p><strong>Status:</strong> <span class="status-badge status-${
              loan.status
            }">${
            loan.status.charAt(0).toUpperCase() + loan.status.slice(1)
          }</span></p>
            <p><strong>Purpose:</strong> ${loan.purpose}</p>
            <p><strong>Description:</strong> ${loan.description}</p>
            <p><strong>Repayment Plan:</strong> ${loan.repaymentPlan}</p>
            ${
              loan.disbursementDate
                ? `<p><strong>Disbursement Date:</strong> ${loan.disbursementDate}</p>`
                : ""
            }
            ${
              loan.approvalDate
                ? `<p><strong>Approval Date:</strong> ${loan.approvalDate}</p>`
                : ""
            }
          `;
          loanDetailModal.classList.add("active");
        }
      }

      // Handle sidebar menu clicks
      document.querySelectorAll(".sidebar-menu a").forEach((item) => {
        item.addEventListener("click", function (e) {
          e.preventDefault();
          document
            .querySelectorAll(".sidebar-menu a")
            .forEach((link) => link.classList.remove("active"));
          this.classList.add("active");
          const menuId = this.id;
          document
            .querySelectorAll(".card")
            .forEach((card) => (card.style.display = "none"));

          if (menuId === "menuDashboard") {
            document.getElementById("dashboardTitle").textContent = "Dashboard";
            document.getElementById("welcomeUserName").textContent =
              currentUser.fullName.split(" ")[0];
            document.getElementById("userProgram").textContent =
              currentUser.program || "No Program Enrolled";
            document.getElementById("recentLoansCard").style.display = "block";
            document.getElementById("programProgressCard").style.display =
              "block";
            document.querySelector(".stats-grid").style.display = "grid";
          } else if (menuId === "menuLoans") {
            document.getElementById("dashboardTitle").textContent =
              "Loan Applications";
            document.getElementById("recentLoansCard").style.display = "block";
            // Hide stats and program progress for loans page
            document.querySelector(".stats-grid").style.display = "none";
            document.getElementById("programProgressCard").style.display =
              "none";
          } else if (menuId === "menuPrograms") {
            document.getElementById("dashboardTitle").textContent =
              "My Programs";
            document.getElementById("programProgressCard").style.display =
              "block";
            // Hide stats and recent loans for programs page
            document.querySelector(".stats-grid").style.display = "none";
            document.getElementById("recentLoansCard").style.display = "none";
          } else if (menuId === "menuProfile") {
            openProfileModal();
          } else if (menuId === "menuSupport") {
            document.getElementById("dashboardTitle").textContent = "Support";
            // Add support content or link here
            document.querySelector(".stats-grid").style.display = "none";
            document.getElementById("recentLoansCard").style.display = "none";
            document.getElementById("programProgressCard").style.display =
              "none";
          } else if (menuId === "menuLogout") {
            handleLogout();
          }
        });
      });

      // Auth navigation event listeners
      showLoginBtn.addEventListener("click", (e) => {
        e.preventDefault();
        showScreen("login");
      });

      showSignupBtn.addEventListener("click", (e) => {
        e.preventDefault();
        showScreen("signup");
      });

      showForgotPasswordBtn.addEventListener("click", (e) => {
        e.preventDefault();
        showScreen("forgotPassword");
      });

      showLoginFromForgotBtn.addEventListener("click", (e) => {
        e.preventDefault();
        showScreen("login");
      });

      // Signup Form Submission
      signupForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const fullName = document.getElementById("signupFullName").value;
        const email = document.getElementById("signupEmail").value;
        const phone = document.getElementById("signupPhone").value;
        const password = document.getElementById("signupPassword").value;
        const confirmPassword = document.getElementById(
          "signupConfirmPassword"
        ).value;

        if (password !== confirmPassword) {
          alert("Passwords do not match!");
          return;
        }

        let registeredUsers = loadRegisteredUsers();
        if (registeredUsers.some((user) => user.email === email)) {
          alert("An account with this email already exists. Please log in.");
          return;
        }

        const medaId = generateMedaId();
        const newUser = {
          fullName,
          email,
          phone,
          password, // In a real app, hash this password!
          medaId,
          program: "YOU-LEAP", // Default program
          loans: [],
        };
        registeredUsers.push(newUser);
        saveRegisteredUsers(registeredUsers);

        alert(
          `Account created successfully! Your MEDA ID is ${medaId}. Please log in.`
        );
        signupForm.reset();
        showScreen("login");
      });

      // Login Form Submission
      loginForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const loginEmail = document.getElementById("loginEmail").value;
        const loginPassword = document.getElementById("loginPassword").value;

        const registeredUsers = loadRegisteredUsers();
        const user = registeredUsers.find(
          (u) => u.email === loginEmail && u.password === loginPassword
        ); // Simplified for demo

        if (user) {
          currentUser = user;
          saveUserData(currentUser); // Persist logged-in user
          updateDashboardUI();
        } else {
          alert("Invalid email or password.");
        }
      });

      // Forgot Password Form Submission
      forgotPasswordForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const forgotEmail = document.getElementById("forgotEmail").value;
        // In a real application, you would send a reset link to the email.
        alert(
          `If an account with ${forgotEmail} exists, a password reset link has been sent.`
        );
        forgotPasswordForm.reset();
        showScreen("login");
      });

      // Logout functionality
      function handleLogout() {
        currentUser = null;
        localStorage.removeItem("currentUser");
        showScreen("login");
        document.getElementById("menuDashboard").classList.add("active"); // Reset active menu
      }
      logoutBtn.addEventListener("click", handleLogout);
      document
        .getElementById("dropdownProfile")
        .addEventListener("click", function (e) {
          e.preventDefault();
          openProfileModal();
        });

      // New Loan Application Modal
      newLoanBtn.addEventListener("click", () => {
        loanApplicationForm.reset();
        document.getElementById("loanTerms").checked = false; // Ensure checkbox is unchecked
        loanModal.classList.add("active");
      });

      closeLoanModalBtn.addEventListener("click", () => {
        loanModal.classList.remove("active");
      });

      cancelLoanBtn.addEventListener("click", () => {
        loanModal.classList.remove("active");
      });

      submitLoanBtn.addEventListener("click", function (e) {
        e.preventDefault(); // Prevent default form submission
        if (!loanApplicationForm.checkValidity()) {
          loanApplicationForm.reportValidity(); // Show native validation errors
          return;
        }

        const loanAmount = document.getElementById("loanAmount").value;
        const loanPurpose = document.getElementById("loanPurpose").value;
        const loanDescription =
          document.getElementById("loanDescription").value;
        const repaymentPlan = document.getElementById("repaymentPlan").value;

        const newLoan = {
          id: `LN-${new Date().getFullYear()}-${String(
            currentUser.loans.length + 1
          ).padStart(3, "0")}`,
          amount: parseFloat(loanAmount),
          date: new Date().toLocaleDateString("en-GB", {
            day: "numeric",
            month: "short",
            year: "numeric",
          }),
          status: "pending",
          purpose: loanPurpose,
          description: loanDescription,
          repaymentPlan: repaymentPlan,
        };

        currentUser.loans.push(newLoan);
        saveUserData(currentUser); // Save updated loans to current user
        updateRegisteredUser(currentUser); // Update user in overall registered users
        updateDashboardUI();
        loanModal.classList.remove("active");
        alert("Loan application submitted successfully!");
      });

      // Loan Detail Modal
      closeLoanDetailModalBtn.addEventListener("click", () => {
        loanDetailModal.classList.remove("active");
      });

      closeDetailBtn.addEventListener("click", () => {
        loanDetailModal.classList.remove("active");
      });

      // Profile Modal
      function openProfileModal() {
        if (currentUser) {
          document.getElementById("profileFullName").value =
            currentUser.fullName;
          document.getElementById("profileEmail").value = currentUser.email;
          document.getElementById("profilePhone").value = currentUser.phone;
          document.getElementById("profileMedaId").value = currentUser.medaId;
          document.getElementById("profileProgram").value =
            currentUser.program || "N/A";

          // Set fields to readonly initially
          document.getElementById("profileFullName").readOnly = true;
          document.getElementById("profileEmail").readOnly = true;
          document.getElementById("profilePhone").readOnly = true;
          document.getElementById("profileProgram").readOnly = true; // Program can't be edited by user
          editProfileBtn.style.display = "block";
          saveProfileBtn.style.display = "none";
          profileModal.classList.add("active");
        }
      }

      closeProfileModalBtn.addEventListener("click", () => {
        profileModal.classList.remove("active");
      });

      menuProfile.addEventListener("click", (e) => {
        e.preventDefault();
        openProfileModal();
      });

      editProfileBtn.addEventListener("click", () => {
        document.getElementById("profileFullName").readOnly = false;
        document.getElementById("profileEmail").readOnly = false;
        document.getElementById("profilePhone").readOnly = false;
        editProfileBtn.style.display = "none";
        saveProfileBtn.style.display = "block";
      });

      saveProfileBtn.addEventListener("click", () => {
        currentUser.fullName = document.getElementById("profileFullName").value;
        currentUser.email = document.getElementById("profileEmail").value;
        currentUser.phone = document.getElementById("profilePhone").value;
        saveUserData(currentUser); // Update current user in local storage
        updateRegisteredUser(currentUser); // Update in the list of registered users
        updateDashboardUI(); // Refresh dashboard with new info
        profileModal.classList.remove("active");
        alert("Profile updated successfully!");
      });

      // Initialize the app
      document.addEventListener("DOMContentLoaded", () => {
        if (currentUser) {
          updateDashboardUI();
        } else {
          showScreen("signup"); // Show signup if no user logged in
        }
      });
    </script>
  </body>
</html>
